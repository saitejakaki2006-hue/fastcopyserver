{% extends "admin/change_form.html" %}
{% load i18n admin_urls %}
{% load payment_filters %}

{% block field_sets %}
<div class="module"
    style="background: var(--body-bg); border: 1px solid var(--border-color); padding: 25px; border-radius: 12px; margin-bottom: 25px; color: var(--body-fg); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">

    <h2
        style="margin-top: 0; color: #2563eb; border-bottom: 2px solid #2563eb; padding-bottom: 12px; font-size: 1.3rem; text-align: left; margin-bottom: 20px; font-weight: 700;">
        üìã Quick Order Overview
    </h2>

    <div style="display: flex; flex-wrap: wrap; gap: 40px;">

        <!-- SERVICE SPECIFICATIONS -->
        <div style="flex: 1; min-width: 320px; border-right: 1px solid var(--border-color); padding-right: 25px;">
            <h4
                style="margin-top: 0; font-size: 12px; text-transform: uppercase; color: var(--body-quiet-color); letter-spacing: 1.2px; margin-bottom: 18px; font-weight: 600;">
                Service Specifications
            </h4>

            <div style="display: grid; grid-template-columns: 1fr; gap: 12px; font-size: 14px;">
                <div>
                    <strong style="color: var(--body-fg);">Service Name:</strong>
                    {{ original.service_name }}
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Print Type:</strong>
                    {% if "CUSTOM" in original.print_mode|upper %}
                    <b
                        style="color:#fd7e14; background: rgba(253, 126, 20, 0.1); padding: 2px 6px; border-radius: 4px;">
                        CUSTOM (Pages: {{ original.custom_color_pages }})
                    </b>
                    {% else %}
                    <span style="font-weight: 600;">{{ original.print_mode|upper }}</span>
                    {% endif %}
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Sides:</strong>
                    {{ original.side_type|upper }}
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Copies Sets:</strong>
                    <span style="font-size: 16px; font-weight: bold;">
                        {{ original.copies }}
                    </span>
                </div>

                <!-- FILE ACCESS BUTTON -->
                <div
                    style="margin-top: 15px; padding: 15px; background: var(--darkened-bg); border-radius: 10px; border: 2px dashed #2563eb; text-align: center;">
                    <strong
                        style="color: var(--body-fg); display: block; margin-bottom: 10px; font-size: 11px; text-transform: uppercase;">
                        Direct Access
                    </strong>

                    {% if original.document %}
                    <a href="{{ original.document.url }}" target="_blank"
                        style="color:white; background:#2563eb; padding:8px 20px; border-radius:6px; text-decoration:none; font-weight: bold; display: inline-block;">
                        üìÑ OPEN PDF DOCUMENT
                    </a>
                    {% elif original.image_upload %}
                    <a href="{{ original.image_upload.url }}" target="_blank"
                        style="color:white; background:#15803d; padding:8px 20px; border-radius:6px; text-decoration:none; font-weight: bold; display: inline-block;">
                        üñºÔ∏è VIEW IMAGE
                    </a>
                    {% else %}
                    <span style="color: var(--body-quiet-color); font-style: italic;">
                        No file path found in database
                    </span>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- CUSTOMER & FINANCIALS -->
        <div style="flex: 1; min-width: 320px;">
            <h4
                style="margin-top: 0; font-size: 12px; text-transform: uppercase; color: var(--body-quiet-color); letter-spacing: 1.2px; margin-bottom: 18px; font-weight: 600;">
                Customer & Financials
            </h4>

            <div style="display: grid; grid-template-columns: 1fr; gap: 10px; font-size: 14px;">
                <!-- BASIC INFO -->
                <div>
                    <strong style="color: var(--body-fg);">Order ID:</strong>
                    <span style="color:#2563eb; font-weight:bold;">
                        {{ original.order_id|default:original.id }}
                    </span>
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Name:</strong>
                    {{ original.user.first_name|default:original.user.username }}
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Mobile:</strong>
                    <span style="font-weight: 600; color: #2563eb;">
                        {{ original.user.profile.mobile|default:original.user.username }}
                    </span>
                </div>

                <div>
                    <strong style="color: var(--body-fg);">Location:</strong>
                    {{ original.location|default:"Not Specified" }}
                </div>

                <!-- COUPON SECTION -->
                <div
                    style="margin-top: 10px; padding: 12px; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 8px;">
                    <strong
                        style="color: #15803d; font-size: 11px; text-transform: uppercase; display: block; margin-bottom: 5px;">
                        Coupon Details
                    </strong>
                    {% if original.coupon_code %}
                    <div style="color: #15803d; font-weight: bold;">
                        Code:
                        <span
                            style="background: #15803d; color: white; padding: 1px 6px; border-radius: 4px; font-family: monospace;">
                            {{ original.coupon_code }}
                        </span>
                    </div>
                    <div style="font-size: 13px; color: #166534; margin-top: 3px;">
                        Savings: <b>‚Çπ{{ original.discount_amount }}</b> (Applied)
                    </div>
                    {% else %}
                    <div style="color: #64748b; font-style: italic; font-size: 13px;">
                        No coupon applied to this order.
                    </div>
                    {% endif %}
                </div>

                <!-- PRICING BREAKDOWN -->
                <div style="margin-top: 5px; color: var(--body-quiet-color); font-size: 13px;">
                    <div>
                        <strong>Original Amount:</strong>
                        ‚Çπ{{ original.original_price|default:original.total_price }}
                    </div>
                    {% if original.coupon_code %}
                    <div style="color: #be123c;">
                        <strong>Discount:</strong>
                        -‚Çπ{{ original.discount_amount }}
                    </div>
                    {% endif %}
                </div>

                <!-- TOTAL & STATUS -->
                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px dashed var(--border-color);">
                    <strong style="color: var(--body-fg);">Final Payable:</strong>
                    <b style="color:#2563eb; font-size:18px;">
                        ‚Çπ{{ original|final_amount }}
                    </b>
                </div>

                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div>
                        <small style="display:block; color:var(--body-quiet-color);">Order Status</small>
                        <span style="font-weight:bold; text-transform: uppercase;">
                            {{ original.status }}
                        </span>
                    </div>
                    <div>
                        <small style="display:block; color:var(--body-quiet-color);">Payment Status</small>
                        <span style="font-weight:bold;
                                   {% if original.payment_status == 'Success' %}
                                       color: #15803d;
                                   {% elif original.payment_status == 'Failed' %}
                                       color: #be123c;
                                   {% else %}
                                       color: #2563eb;
                                   {% endif %}">
                            {{ original.payment_status|upper }}
                        </span>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

{{ block.super }}
{% endblock %}