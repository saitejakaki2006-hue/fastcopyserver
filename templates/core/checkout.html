{% extends 'base.html' %} 
{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card border-0 bg-dark text-white rounded-4 shadow-lg overflow-hidden border-top border-primary border-5" data-aos="zoom-in">
                <div class="card-body p-5 text-center">
                    <h2 class="text-uppercase fw-black italic mb-4">Confirm <span class="text-primary">Payment</span></h2>
                    
                    <div class="my-4 py-3 bg-secondary bg-opacity-10 rounded-3 border border-secondary border-opacity-25">
                        <span class="text-uppercase small opacity-75 d-block mb-1">Total Amount Payable ({{ items_count }} Items)</span>
                        <h1 class="fw-black text-primary mb-0">₹{{ grand_total }}</h1>
                    </div>

                    <div class="text-start mb-4">
                        <h6 class="text-uppercase small fw-bold text-primary mb-3 tracking-widest">Order Summary:</h6>
                        <div class="d-grid gap-2">
                            {% for item in cart_items %}
                            <div class="d-flex justify-content-between align-items-center p-3 rounded bg-secondary bg-opacity-10 border border-secondary border-opacity-10">
                                <div class="overflow-hidden">
                                    <p class="small mb-0 fw-black text-uppercase italic text-truncate" style="max-width: 220px;">
                                        {{ item.service_name }}
                                    </p>
                                    <p class="mb-0 opacity-50 text-truncate" style="font-size: 0.65rem;">
                                        {{ item.document_name|default:"Document File" }}
                                    </p>
                                </div>
                                <div class="text-end">
                                    <span class="fw-black text-white small">₹{{ item.total_price }}</span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <hr class="border-secondary opacity-25 my-4">

                    <div class="d-grid gap-3">
                        <a href="{% url 'initiate_payment' %}" class="btn btn-primary btn-lg py-3 rounded-pill fw-black text-uppercase tracking-widest shadow-lg hover-scale transition-all">
                            Pay ₹{{ grand_total }} via PhonePe <i class="fas fa-credit-card ms-2"></i>
                        </a>

                        <a href="{% url 'bypass_payment' %}" class="btn btn-outline-warning py-2 rounded-pill fw-bold text-uppercase tracking-widest transition-all" style="font-size: 0.75rem;">
                            <i class="fas fa-vial me-2"></i> Simulate Success (Test Mode)
                        </a>
                    </div>

                    <div class="mt-4 pt-2">
                        <p class="text-muted small mb-0 opacity-75">
                            <i class="fas fa-shield-alt text-primary me-1"></i> Secure Encrypted Transaction
                        </p>
                        <p class="text-muted italic mt-2" style="font-size: 0.6rem; line-height: 1.4;">
                            Note: Your order will be placed and the cart will be cleared only after payment confirmation. <br>
                            <span class="text-warning">Use "Test Mode" only for development modifications.</span>
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-4">
                <a href="{% url 'cart' %}" class="text-white text-decoration-none opacity-50 small hover-opacity-100 transition-all">
                    <i class="fas fa-chevron-left me-1"></i> Back to Cart
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    .fw-black { font-weight: 900; }
    .italic { font-style: italic; }
    .tracking-widest { letter-spacing: 0.15em; }
    
    .hover-scale { transition: transform 0.2s; }
    .hover-scale:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 20px rgba(13, 110, 253, 0.3) !important;
    }

    .btn-outline-warning:hover {
        background-color: #ffc107;
        color: #000 !important;
    }

    .hover-opacity-100:hover {
        opacity: 1 !important;
    }
    
    .transition-all {
        transition: all 0.3s ease;
    }
</style>
{% endblock %}