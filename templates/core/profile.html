{% extends 'base.html' %}
{% block content %}
<div class="container mx-auto px-6 py-12 max-w-4xl" data-aos="fade-up">
    
    <div class="bg-white rounded-[3rem] shadow-2xl p-10 flex flex-wrap justify-between items-center mb-10 border-b-[12px] border-blue-600">
        <div class="flex items-center gap-6">
            <div class="w-20 h-20 bg-slate-900 rounded-3xl flex items-center justify-center text-white text-3xl shadow-xl rotate-3"><i class="fas fa-user-circle"></i></div>
            <div>
                <h1 class="text-4xl font-black text-slate-800 uppercase italic">Hi, {{ user.first_name|default:user.username }}</h1>
                <p class="text-blue-600 font-bold uppercase text-[10px] tracking-widest"><i class="fas fa-phone mr-2"></i>{{ profile.mobile }}</p>
            </div>
        </div>
        <button onclick="toggleModal('editModal')" class="px-8 py-4 bg-slate-900 text-white rounded-full font-black uppercase text-[10px] tracking-widest hover:scale-105 shadow-xl">Edit Profile</button>
    </div>

    <div class="mb-12">
        <h3 class="text-[10px] font-black uppercase text-slate-400 mb-6 tracking-[0.4em]">Current Status</h3>
        {% if tracking %}
        <div class="bg-slate-900 rounded-[3.5rem] p-12 text-white shadow-2xl">
            <div class="flex justify-between items-center">
                <div class="text-center">
                    <div class="w-12 h-12 rounded-xl bg-blue-600 flex items-center justify-center mb-2"><i class="fas fa-sync fa-spin"></i></div>
                    <p class="text-[8px] font-black uppercase">In Progress</p>
                </div>
                <div class="h-1 flex-1 bg-slate-800 mx-4"><div class="h-full bg-blue-600" style="width:50%"></div></div>
                <div class="text-center">
                    <div class="w-12 h-12 rounded-xl bg-slate-800 flex items-center justify-center mb-2"><i class="fas fa-check"></i></div>
                    <p class="text-[8px] font-black uppercase text-slate-500">Ready</p>
                </div>
            </div>
        </div>
        {% else %}
        <div class="p-10 border-2 border-dashed rounded-[3rem] text-center text-slate-400 uppercase font-black text-xs">No active orders</div>
        {% endif %}
    </div>

    <div class="text-center mt-20">
        <button onclick="confirmLogout()" class="px-12 py-5 bg-red-50 text-red-600 rounded-full font-black uppercase text-[10px] tracking-widest hover:bg-red-600 hover:text-white transition-all shadow-xl">
            <i class="fas fa-power-off mr-2"></i> Logout Session
        </button>
    </div>

    <div id="editModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-6">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-md" onclick="toggleModal('editModal')"></div>
        <div class="bg-white w-full max-w-lg rounded-[3rem] shadow-2xl relative z-10 p-10 border-t-[12px] border-blue-600">
            <h2 class="text-2xl font-black uppercase italic mb-8">Edit <span class="text-blue-600">Profile</span></h2>
            <form action="{% url 'edit_profile' %}" method="POST" class="space-y-4">
                {% csrf_token %}
                <input type="text" name="name" value="{{ user.first_name }}" placeholder="Full Name" class="w-full p-4 bg-slate-50 rounded-2xl outline-none ring-1 ring-slate-100 focus:ring-2 focus:ring-blue-600 font-bold">
                <input type="text" name="mobile" value="{{ profile.mobile }}" placeholder="Mobile" class="w-full p-4 bg-slate-50 rounded-2xl outline-none ring-1 ring-slate-100 focus:ring-2 focus:ring-blue-600 font-bold">
                <textarea name="address" placeholder="Address" class="w-full p-4 bg-slate-50 rounded-2xl outline-none ring-1 ring-slate-100 focus:ring-2 focus:ring-blue-600 font-bold h-32">{{ profile.address }}</textarea>
                <button type="submit" class="w-full py-5 bg-slate-900 text-white rounded-full font-black uppercase text-[10px] tracking-widest">Save Changes</button>
            </form>
        </div>
    </div>
</div>

<script>
function toggleModal(id) { document.getElementById(id).classList.toggle('hidden'); }
function confirmLogout() {
    if(confirm("Logout and return to Home page?")) { window.location.href = "{% url 'logout' %}"; }
}
</script>
{% endblock %}